{
  "info": {
    "_postman_id": "6f6939a0-6209-42f0-b2c8-74fa8efd668c",
    "name": "chaining Students collection",
    "description": "# **Overview**\n\n- **Purpose:** End-to-end API chaining test for /students CRUD flow using Postman collection variables.\n    \n- **Base URL:** Requests use [http://localhost:3000](http://localhost:3000) (first request prerequest script sets stage44, while requests themselves use stage-url).\n    \n- **Main flow (in order):**\n    \n\n1. **Get all students data** (GET /students)\n    \n2. **Create new Student** (POST /students) with randomized name/location/phone/age/grade/courses\n    \n3. **Get a student** (GET /students/{{stId}}) to verify created student\n    \n4. **Update a student details** (PUT /students/{{stId}}) with newly randomized full payload\n    \n5. **Get an updated student** (GET /students/{{stId}}) to verify PUT changes\n    \n6. **Update specific detail** (PATCH /students/{{stId}}) for partial fields (name/location/age)\n    \n7. **Delete a student** (DELETE /students/{{stId}})\n    \n\n- **Chaining strategy:**\n    \n\nThe collection saves values from create/update responses into collection variables (stId, studentName, updatedName, etc.) and reuses them in later requests for URL path params, request bodies, and assertions.\n\n- **Validation coverage across requests:**\n    \n    - HTTP status and response time checks\n        \n    - Header checks (Content-Type: application/json)\n        \n    - Cookie checks (e.g., Language=english, sometimes Name=employees)\n        \n    - JSON schema validation via tv4\n        \n    - Data consistency assertions between stored variables and returned response data\n        \n- **Data generation logic:**\n    \n    - Uses Postman dynamic variables for text fields\n        \n    - Random age/grade selection\n        \n    - Random subset selection for courses, stored and reused between requests\n        \n- **Cleanup at delete step:**  \n    Attempts to unset several collection variables after deletion.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "12513559",
    "_collection_link": "https://go.postman.co/collection/12513559-6f6939a0-6209-42f0-b2c8-74fa8efd668c?source=collection_link"
  },
  "item": [
    {
      "name": "Get all students data",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "//create environment\r",
              "pm.environment.set('stage44',\"http://localhost:3000\")\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test(\"status code is 200\",function(){\r",
              "        pm.response.to.have.status(\"OK\")\r",
              "        pm.response.to.have.status(200)\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"response time is less than 2000 ms\",function(){\r",
              "    pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the headers contains 'content-type'and its value is application/json\r",
              "\r",
              "pm.test(\"Content-Type header exists and its value is application/json\",function(){\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "})\r",
              "\r",
              "\r",
              "//veify the cookies \r",
              "\r",
              "pm.test(\"veify the cookies \",function(){\r",
              "  pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "})\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "const jsonScheme={\r",
              "    \r",
              "  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "  \"type\": \"array\",\r",
              "  \"items\": [\r",
              "    {\r",
              "      \"type\": \"object\",\r",
              "      \"properties\": {\r",
              "        \"id\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"name\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"location\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"phone\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"age\": {\r",
              "          \"type\": \"integer\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"subjects\": {\r",
              "          \"type\": \"array\",\r",
              "          \"items\": [\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            }\r",
              "          ]\r",
              "        }\r",
              "      },\r",
              "      \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"subjects\"\r",
              "      ]\r",
              "    },\r",
              "    {\r",
              "      \"type\": \"object\",\r",
              "      \"properties\": {\r",
              "        \"id\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"name\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"location\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"phone\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"age\": {\r",
              "          \"type\": \"integer\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"courses\": {\r",
              "          \"type\": \"array\",\r",
              "          \"items\": [\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            }\r",
              "          ]\r",
              "        }\r",
              "      },\r",
              "      \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "      ]\r",
              "    },\r",
              "    {\r",
              "      \"type\": \"object\",\r",
              "      \"properties\": {\r",
              "        \"id\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"name\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"location\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"phone\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"age\": {\r",
              "          \"type\": \"integer\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"courses\": {\r",
              "          \"type\": \"array\",\r",
              "          \"items\": [\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            }\r",
              "          ]\r",
              "        }\r",
              "      },\r",
              "      \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "      ]\r",
              "    },\r",
              "    {\r",
              "      \"type\": \"object\",\r",
              "      \"properties\": {\r",
              "        \"id\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"name\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"location\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"phone\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"age\": {\r",
              "          \"type\": \"integer\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"courses\": {\r",
              "          \"type\": \"array\",\r",
              "          \"items\": [\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            }\r",
              "          ]\r",
              "        }\r",
              "      },\r",
              "      \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "      ]\r",
              "    },\r",
              "    {\r",
              "      \"type\": \"object\",\r",
              "      \"properties\": {\r",
              "        \"id\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"name\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"location\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"phone\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"age\": {\r",
              "          \"type\": \"integer\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "          \"type\": \"string\"\r",
              "        },\r",
              "        \"courses\": {\r",
              "          \"type\": \"array\",\r",
              "          \"items\": [\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            },\r",
              "            {\r",
              "              \"type\": \"string\"\r",
              "            }\r",
              "          ]\r",
              "        }\r",
              "      },\r",
              "      \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "      ]\r",
              "    }\r",
              "  ]\r",
              "}\r",
              "\r",
              "\r",
              "//creating a variable for the response body.\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "//verify that the response body and the generated json scheme have the same structure\r",
              "pm.test(\"scheme validated\",function(){\r",
              "    pm.expect(tv4.validate(jsonData , jsonScheme)).to.be.true\r",
              "})\r",
              "\r",
              "//veify the data type of each field\r",
              "pm.test(\"validate the fields\",function(){\r",
              "    pm.expect(jsonData).to.be.an(\"array\")\r",
              "   pm.expect(jsonData[0].id ).to.be.a(\"string\")\r",
              "   pm.expect(jsonData[0].name).to.be.a(\"string\")\r",
              "   pm.expect(jsonData[0].location).to.be.a(\"string\")\r",
              "   pm.expect(jsonData[0].phone).to.be.a(\"string\")\r",
              "   pm.expect(jsonData[0].age).to.be.a(\"number\")\r",
              "   pm.expect(jsonData[0].subjects).to.be.an(\"array\")\r",
              "\r",
              "})"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "text"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Create new Student",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "//create a variable for random name ,Location , Phone\r",
              "pm.collectionVariables.set('stnName','{{$randomFullName}}')\r",
              "pm.collectionVariables.set('stLocation','{{$randomCountry}}')\r",
              "pm.collectionVariables.set('stPhone','{{$randomPhoneNumber}}')\r",
              "\r",
              "\r",
              "//Note : if the ages property contains a dropdown of static values then we can use these steps to select a random value of the dropdown\r",
              "//let randomValue=arrayname[index]\r",
              "//index-->how to select a random index of the array\r",
              "//Math.floor()--> to round to the nearest integer\r",
              "//Math.random()---> provide eachtime different decimal number between 0-1\r",
              "//randomvalue=arrayname[Math.floor(Math.random()*arrayname.length)]--> to select each time a different element\r",
              "let ages=[6 , 7 , 8 , 9 , 10 , 11 , 12 , 13 , 14 , 15]\r",
              "let randomAge=ages[Math.floor(Math.random()*ages.length)]\r",
              "console.log(\"the number is \"+ randomAge)\r",
              "pm.collectionVariables.set('stAge',randomAge)\r",
              "\r",
              "//Grade key\r",
              "let grades=['1st', '2nd' , '3rd' , '4th' , '5th' , '6th' , '7th' , '8th' , '9th' , '10th']\r",
              "//stored the grades array as 'string' in a collection variable --> '['' , '' , '']' -->this called an array [] ,stored as string'[]'\r",
              "\r",
              "//setting a variable collection of 'allGrades' to store 'grades' as a string array to recal it later in another API\r",
              "pm.collectionVariables.set('allGrades' , JSON.stringify(grades))\r",
              "\r",
              "console.log(pm.collectionVariables.get('allGrades'))\r",
              "\r",
              "//selecting a random grade and store it to a variable 'randomGrade'\r",
              "let randomGrade=grades[Math.floor(Math.random()*grades.length)]\r",
              "\r",
              "console.log(randomGrade)\r",
              "\r",
              "//setting a collection variable 'stGrade' for the random grade  \r",
              "pm.collectionVariables.set('stGrade',randomGrade)\r",
              "\r",
              "\r",
              "//courses array\r",
              "let allCourses=[ \"python\",\r",
              "    \"Java\",\r",
              "    \"Java Script\",\r",
              "    \"Selenium\",\r",
              "    \"playwright\",\r",
              "    \"cypress\",\r",
              "    \"SQL\",\r",
              "    \"Testing\",\r",
              "    \"Agile\"]\r",
              "\r",
              "//store the array as a string in a collection variabel to use it later in other API\r",
              "\r",
              "pm.collectionVariables.set('coursesString',JSON.stringify(allCourses))\r",
              "console.log(pm.collectionVariables.get('coursesString'))\r",
              "\r",
              "\r",
              "//set a function that can return an array of random combination of the selected courses by passing the size parameter of the new array\r",
              "function getRandomSubset(array,size){\r",
              " /*arrayname.slice()--> to create a new version of the array(by rearranging the order of the elements)\r",
              ".sort(()=>0.5 - Math.random()) --> this method will support the way of rearranging\r",
              "array.slice(start element index , end element index)--> this method\r",
              "newarray(0,size)--> start from 0 index and end at the index number equal the size that will be passed to the parameter function.\r",
              "0--> is element index   size -> the size of the elements that should be existing in the array (not an index of an element)\r",
              "for ex: array[0,1,2,3,4,5,6,7,8,9] => slice(0,5) =>  new array=[0,1,2,3,4] =>only 5 elements starting of index 0 \r",
              "  .slice(0,2)=>  new array=[0,1,] => only two elements starting of index 0 \r",
              " .slice(0,5) --> will return the elements starting of index 0 until the index of element 4 not 5 (that means only 5 elements will be in the array)*/\r",
              "   \r",
              "let newArray= array.slice().sort(()=>0.5 - Math.random())\r",
              "return newArray.slice(0,size)\r",
              "\r",
              "                                      }\r",
              "                                      \r",
              "//creating random size parameter to use it in the previous function\r",
              "let randomSize=Math.floor(Math.random() * allCourses.length)+1\r",
              "\r",
              "console.log(randomSize)\r",
              "\r",
              "//to store the func in a variable to recall it in another API\r",
              "//funname.toString() ---> converts the function to string to save it in a variable \r",
              "pm.collectionVariables.set('randomCourses', getRandomSubset.toString())\r",
              "\r",
              "//storing the new array of the random combination of the courses in a variable\r",
              "let newCourses=getRandomSubset(allCourses,randomSize)\r",
              "\r",
              "console.log(newCourses)\r",
              "\r",
              "//set a collection variable 'stCourses' of the new courses\r",
              "pm.collectionVariables.set('stCourses',JSON.stringify(newCourses))\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 201.\r",
              "\r",
              "pm.test(\"status code is 201 OK\",function(){\r",
              "    pm.response.to.have.status(\"Created\")\r",
              "    pm.response.to.have.status(201)\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"response time is less than 2000\",function(){\r",
              "pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "})\r",
              "\r",
              "\r",
              "//veify the cookies\r",
              "//verify that the headers contains 'content-type'and its value is application/json\r",
              "\r",
              "\r",
              "pm.test(\"cookies & headers validation\",function(){\r",
              "    pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//creating a variable for the response body.\r",
              "\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "\r",
              "const jsonScheme={\r",
              "  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "  \"description\": \"\",\r",
              "  \"type\": \"object\",\r",
              "  \"properties\": {\r",
              "    \"id\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"name\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"location\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"phone\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"age\": {\r",
              "      \"type\": \"number\"\r",
              "    },\r",
              "    \"grade\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"courses\": {\r",
              "      \"type\": \"array\",\r",
              "      \"items\": {\r",
              "        \"required\": [],\r",
              "        \"properties\": {}\r",
              "      }\r",
              "    }\r",
              "  },\r",
              "  \"required\": [\r",
              "    \"id\",\r",
              "    \"name\",\r",
              "    \"location\",\r",
              "    \"phone\",\r",
              "    \"age\",\r",
              "    \"grade\",\r",
              "    \"courses\"\r",
              "  ]\r",
              "}\r",
              "\r",
              "\r",
              "//verify that the response body and the geneated json scheme have the same structure\r",
              "\r",
              "\r",
              "pm.test(\"scheme validation\",function(){\r",
              "    pm.expect(tv4.validate(jsonData,jsonScheme)).to.be.true\r",
              "})\r",
              "\r",
              "\r",
              "//setting collection variables of the data used in creation to compare it with the response body of the API that return the data of the created student.\r",
              "\r",
              "pm.collectionVariables.set('studentName',jsonData.name)\r",
              "pm.collectionVariables.set('studentAge',jsonData.age)\r",
              "pm.collectionVariables.set('stId',jsonData.id)\r",
              "pm.collectionVariables.set('studentLocation',jsonData.location)\r",
              "pm.collectionVariables.set('studentGrade',jsonData.grade)\r",
              "pm.collectionVariables.set('studentCourses',jsonData.courses)\r",
              "pm.collectionVariables.set('studentPhone',jsonData.phone)\r",
              "\r",
              "\r",
              "  \r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n  \r\n  \"name\":\"{{stnName}}\" ,\r\n  \"location\": \"{{stLocation}}\",\r\n  \"phone\": \"{{stPhone}}\",\r\n  \"age\": {{stAge}},\r\n  \"grade\": \"{{stGrade}}\",\r\n  \"courses\": {{stCourses}}\r\n  \r\n}\r\n",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get a student",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test(\"status code is 200 OK\",function(){\r",
              "\r",
              "    pm.response.to.have.status(200)\r",
              "    pm.response.to.have.status(\"OK\")\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"Response time is less than 2000 ms\",function(){\r",
              "\r",
              "    pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//veify that the headers contains 'Content-Type' and its value is 'application/json'\r",
              "\r",
              "pm.test(\"verify Content-Type header \",function(){\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "\r",
              "})\r",
              "\r",
              "//veify the cookies\r",
              "\r",
              "pm.test(\"verify the cookie value\",function(){\r",
              "   pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//creating a variable for the response body.\r",
              "\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "\r",
              "const jsonScheme={\r",
              "  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "  \"description\": \"\",\r",
              "  \"type\": \"object\",\r",
              "  \"properties\": {\r",
              "    \"id\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"name\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"location\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"phone\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"age\": {\r",
              "      \"type\": \"number\"\r",
              "    },\r",
              "    \"grade\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"courses\": {\r",
              "      \"type\": \"array\",\r",
              "      \"items\": {\r",
              "        \"required\": [],\r",
              "        \"properties\": {}\r",
              "      }\r",
              "    }\r",
              "  },\r",
              "  \"required\": [\r",
              "    \"id\",\r",
              "    \"name\",\r",
              "    \"location\",\r",
              "    \"phone\",\r",
              "    \"age\",\r",
              "    \"grade\",\r",
              "    \"courses\"\r",
              "  ]\r",
              "}\r",
              "\r",
              "\r",
              "\r",
              "//verify that the response body and the geneated json scheme have the same structure\r",
              "\r",
              "pm.test(\"response data is validated\",function(){\r",
              "    pm.expect(tv4.validate(jsonData,jsonScheme)).to.be.true\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the returned data in the response body and the data used in creation are the same\r",
              "\r",
              "pm.test(\"verifying the data of the student\",function(){\r",
              "    pm.expect(jsonData.id).to.eql(pm.collectionVariables.get('stId'))\r",
              "    pm.expect(jsonData.name).to.eql(pm.collectionVariables.get('studentName'))\r",
              "    pm.expect(jsonData.location).to.eql(pm.collectionVariables.get('studentLocation'))\r",
              "    pm.expect(jsonData.phone).to.eql(pm.collectionVariables.get('studentPhone'))\r",
              "    pm.expect(jsonData.age).to.eql(pm.collectionVariables.get('studentAge'))\r",
              "    pm.expect(jsonData.grade).to.eql(pm.collectionVariables.get('studentGrade'))\r",
              "    pm.expect(jsonData.courses).to.eql(pm.collectionVariables.get('studentCourses'))\r",
              "\r",
              "})"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students/{{stId}}",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students",
            "{{stId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Update student details",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "//creating random data and stetting them as collection variables\r",
              "pm.collectionVariables.set('upName','{{$randomFullName}}')\r",
              "pm.collectionVariables.set('uplocation','{{$randomCountry}}')\r",
              "pm.collectionVariables.set('upPhone','{{$randomPhoneNumber}}')\r",
              "\r",
              "//Note: we can generate random ages between 9 and 6 if we have a free text input not  dropdown of static/fixed selections or options\r",
              "\r",
              "pm.collectionVariables.set('upAge',Math.floor(Math.random()*9)+6)\r",
              "\r",
              "//recall the allGrades array which is stored as 'string' in a collection variable\r",
              "let gradesdb=pm.collectionVariables.get('allGrades')\r",
              "\r",
              "//to Parse it ('allGrades')-->back into an array -->from '[]'  into  []\r",
              "let gradesArray= JSON.parse(gradesdb)\r",
              "\r",
              "//selecting a random element in gradesArray and store the in randomGrade variable\r",
              "randomGrade= gradesArray[Math.floor(Math.random()+gradesArray.length)]\r",
              "\r",
              "//setting a collection variable 'upGrade' of the new selected grade\r",
              "pm.collectionVariables.set('upGrade',randomGrade)\r",
              "\r",
              "\r",
              "\r",
              "//recall the courses dropdown array from the \"create new user API\"\r",
              "let coursesdb=pm.collectionVariables.get('coursesString')\r",
              "let coursesArray=JSON.parse(coursesdb)\r",
              "let randomSize=Math.floor(Math.random()*coursesArray.length)+1\r",
              "\r",
              "//recalling variable randomCourses which contains a string of a function to use it in this api\r",
              "\r",
              "let coursesFun=pm.collectionVariables.get('randomCourses')\r",
              "//retrive the string function to function\r",
              "eval(\"var selectedCourses = \" + coursesFun)\r",
              "let newCourses=selectedCourses(coursesArray,randomSize)\r",
              "pm.collectionVariables.set('upCourses', JSON.stringify(newCourses))\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              "\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test(\"status is 200 ok\",function(){\r",
              "pm.response.to.have.status(200)\r",
              "pm.response.to.have.status(\"OK\")\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"response time is less than 2000\",function(){\r",
              "    pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "    \r",
              "})\r",
              "\r",
              "//veify that the headers contains 'Content-Type' and its value is 'application/json'\r",
              "\r",
              "//veify the cookies \r",
              "\r",
              "pm.test(\"cookies and headers validation\",function(){\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "   pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "    \r",
              "})\r",
              "\r",
              "//creating a variable for the response body.\r",
              "\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "\r",
              "const jsonScheme={\r",
              "    \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "    \"description\": \"\",\r",
              "    \"type\": \"object\",\r",
              "    \"properties\": {\r",
              "        \"id\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"name\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"location\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"phone\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"age\": {\r",
              "            \"type\": \"number\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"courses\": {\r",
              "            \"type\": \"array\",\r",
              "            \"items\": {\r",
              "                \"required\": [],\r",
              "                \"properties\": {}\r",
              "            }\r",
              "        }\r",
              "    },\r",
              "    \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "    ]\r",
              "}\r",
              "\r",
              "\r",
              "\r",
              "//verify that the response body and the geneated json scheme have the same structure\r",
              "\r",
              "pm.test(\"Scheme validation\",function(){\r",
              "    pm.expect(tv4.validate(jsonData,jsonScheme)).to.be.true\r",
              "})\r",
              "\r",
              "\r",
              "//veify that the student id (sent in the endpoint as a parameter 'stId' ) is the same as the returned one in the response body\r",
              "\r",
              "pm.test('assert that the id correct',function(){\r",
              "\r",
              "    pm.expect(jsonData.id).to.eql(pm.collectionVariables.get('stId'))\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//creating collection vraiables of the response data  \r",
              "pm.collectionVariables.set('updatedName',jsonData.name)\r",
              "pm.collectionVariables.set('updatedAge',jsonData.age)\r",
              "pm.collectionVariables.set('updatedlocation',jsonData.location)\r",
              "\r",
              "pm.collectionVariables.set('updatedPhone',jsonData.phone)\r",
              "pm.collectionVariables.set('updatedGrade',jsonData.grade)\r",
              "pm.collectionVariables.set('updatedCourses',jsonData.courses)\r",
              "\r",
              "\r",
              "\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "\r\n {\r\n        \r\n        \"name\": \"{{upName}}\",\r\n        \"location\": \"{{uplocation}}\",\r\n        \"phone\": \"{{upPhone}}\",\r\n        \"age\": {{upAge}},\r\n        \"grade\": \"{{upGrade}}\",\r\n        \"courses\": {{upCourses}}\r\n\r\n}\r\n",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students/{{stId}}",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students",
            "{{stId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get an updated student",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test(\"status code is 200 OK\",function(){\r",
              "\r",
              "    pm.response.to.have.status(200)\r",
              "    pm.response.to.have.status(\"OK\")\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"Response time is less than 2000 ms\",function(){\r",
              "\r",
              "    pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "\r",
              "})\r",
              "\r",
              "\r",
              "//veify that the headers contains 'Content-Type' and its value is 'application/json'\r",
              "\r",
              "pm.test(\"verify Content-Type header\",function(){\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "\r",
              "})\r",
              "\r",
              "pm.test(\"verify the cookie value\",function(){\r",
              "   pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "\r",
              "})\r",
              "\r",
              "//creating a variable for the response body.\r",
              "\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "\r",
              "const jsonScheme={\r",
              "  \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "  \"description\": \"\",\r",
              "  \"type\": \"object\",\r",
              "  \"properties\": {\r",
              "    \"id\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"name\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"location\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"phone\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"age\": {\r",
              "      \"type\": \"number\"\r",
              "    },\r",
              "    \"grade\": {\r",
              "      \"type\": \"string\",\r",
              "      \"minLength\": 1\r",
              "    },\r",
              "    \"courses\": {\r",
              "      \"type\": \"array\",\r",
              "      \"items\": {\r",
              "        \"required\": [],\r",
              "        \"properties\": {}\r",
              "      }\r",
              "    }\r",
              "  },\r",
              "  \"required\": [\r",
              "    \"id\",\r",
              "    \"name\",\r",
              "    \"location\",\r",
              "    \"phone\",\r",
              "    \"age\",\r",
              "    \"grade\",\r",
              "    \"courses\"\r",
              "  ]\r",
              "}\r",
              "\r",
              "//verify that the response body and the geneated json scheme have the same structure\r",
              "\r",
              "pm.test(\"response data is validated\",function(){\r",
              "    pm.expect(tv4.validate(jsonData,jsonScheme)).to.be.true\r",
              "\r",
              "})\r",
              "\r",
              "//verify that the response data and the updated data are the same\r",
              "\r",
              "pm.test(\"verify the response data\",function(){\r",
              "    pm.expect(jsonData.id).to.eql(pm.collectionVariables.get('stId'))\r",
              "    pm.expect(jsonData.name).to.eql(pm.collectionVariables.get('updatedName'))\r",
              "    pm.expect(jsonData.location).to.eql(pm.collectionVariables.get('updatedlocation'))\r",
              "    pm.expect(jsonData.phone).to.eql(pm.collectionVariables.get('updatedPhone'))\r",
              "    pm.expect(jsonData.age).to.eql(pm.collectionVariables.get('updatedAge'))\r",
              "    pm.expect(jsonData.grade).to.eql(pm.collectionVariables.get('updatedGrade'))\r",
              "    pm.expect(jsonData.courses).to.eql(pm.collectionVariables.get('updatedCourses'))\r",
              "\r",
              "})\r",
              "\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "protocolProfileBehavior": {
        "disableBodyPruning": true
      },
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students/{{stId}}",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students",
            "{{stId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Update specific detail",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              "//creating collection vraiables of the updated data  \r",
              "\r",
              "\r",
              "pm.collectionVariables.set('newUpName','{{$randomFullName}}')\r",
              "pm.collectionVariables.set('newUplocation','{{$randomCountry}}')\r",
              "pm.collectionVariables.set('newUpAge', Math.floor(Math.random()*9)+6)"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test(\"status code is 200 OK\",function(){\r",
              "  pm.response.to.have.status(\"OK\")\r",
              "  pm.response.to.have.status(200)\r",
              "})\r",
              "\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "pm.test(\"response time is less than 2000\",function(){\r",
              "    pm.expect(pm.response.responseTime).to.be.lessThan(2000)\r",
              "})\r",
              "\r",
              "//veify that the headers contains 'Content-Type' and its value is 'application/json'\r",
              "\r",
              "//veify the cookies value\r",
              "\r",
              "pm.test(\"cookies and headers are validated\",function(){\r",
              "    pm.expect(pm.request.headers.get(\"Cookie\")).to.be.eql(pm.environment.get(\"mycookie\"))\r",
              "    pm.response.to.have.header(\"Content-Type\")\r",
              "    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\")\r",
              "\r",
              "})\r",
              "\r",
              "//creating a variable for the response body.\r",
              "\r",
              "const jsonData=pm.response.json()\r",
              "\r",
              "//creating a variable of the generated json Schema to verify the response \r",
              "\r",
              "const jsonScheme={\r",
              "    \"$schema\": \"http://json-schema.org/draft-04/schema#\",\r",
              "    \"description\": \"\",\r",
              "    \"type\": \"object\",\r",
              "    \"properties\": {\r",
              "        \"id\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"name\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"location\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"phone\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"age\": {\r",
              "            \"type\": \"number\"\r",
              "        },\r",
              "        \"grade\": {\r",
              "            \"type\": \"string\",\r",
              "            \"minLength\": 1\r",
              "        },\r",
              "        \"courses\": {\r",
              "            \"type\": \"array\",\r",
              "            \"items\": {\r",
              "                \"required\": [],\r",
              "                \"properties\": {}\r",
              "            }\r",
              "        }\r",
              "    },\r",
              "    \"required\": [\r",
              "        \"id\",\r",
              "        \"name\",\r",
              "        \"location\",\r",
              "        \"phone\",\r",
              "        \"age\",\r",
              "        \"grade\",\r",
              "        \"courses\"\r",
              "    ]\r",
              "}\r",
              "\r",
              "\r",
              "//verify that the response body and the geneated json scheme have the same structure\r",
              "\r",
              "pm.test(\"json scheme is validated\",function(){\r",
              "    pm.expect(tv4.validate(jsonData,jsonScheme)).to.be.true\r",
              "    \r",
              "})\r",
              "\r",
              "//verify that the sent 'studentid' in the endpont is the same as the returned on e in the response \r",
              "pm.test('assert the student id' , function(){\r",
              "    pm.expect(jsonData.id).to.eql(pm.collectionVariables.get('stId'))\r",
              "\r",
              "})\r",
              "\r",
              "//creating collection vraiables of the response data  \r",
              "\r",
              "pm.collectionVariables.set('newName', jsonData.name)\r",
              "pm.collectionVariables.set('newlocation',jsonData.location)\r",
              "pm.collectionVariables.set('newAge' , jsonData.age)\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "PATCH",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{ \r\n    \r\n    \"name\": \"{{newUpName}}\",\r\n    \"location\": \"{{newUplocation}}\",\r\n    \"age\":{{newUpAge}}\r\n    \r\n    }",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{stage-url}}/students/{{stId}}",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students",
            "{{stId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Delete a student",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "test",
          "script": {
            "exec": [
              "//verify that the status code of the API is 200.\r",
              "\r",
              "pm.test('status code is 200 and status msg is OK',function(){\r",
              "    pm.response.to.have.status(200)\r",
              "    pm.response.to.have.status(\"OK\")\r",
              "\r",
              "})\r",
              "\r",
              "//verify that the response time is less than 2000 ms.\r",
              "\r",
              "\r",
              "pm.test('response time is less than 2000 ms',function(){\r",
              "    pm.expect(pm.response.responseTime).to.be.below(2000)\r",
              "})\r",
              "\r",
              "//veify that the headers contains 'Content-Type' and its value is 'application/json'\r",
              "\r",
              "pm.test('verify Content-Type header',function(){\r",
              "    pm.response.to.have.header('Content-Type')\r",
              "    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json')\r",
              "})\r",
              "\r",
              "\r",
              "//clear all created collection variables  \r",
              "\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('stId'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedName'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('newUpName'))\r",
              "\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedlocation'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('newUplocation'))\r",
              "\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedPhone'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedAge'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('newUpAge'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedGrade'))\r",
              "pm.collectionVariables.unset(pm.collectionVariables.get('updatedCourses'))\r",
              "\r",
              "\r",
              "\r",
              "\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Cookie",
            "value": "{{mycookie}}",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{stage-url}}/students/{{stId}}",
          "host": [
            "{{stage-url}}"
          ],
          "path": [
            "students",
            "{{stId}}"
          ]
        }
      },
      "response": []
    }
  ]
}